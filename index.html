// ===== PHẦN 1 =====
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PARKOUR ULTIMATE SOUL — GOD MODE 7.1 FULL</title>
<style>
/* =====================
   RESET & GLOBAL
===================== */
html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: 'Press Start 2P', monospace;
    background: #000;
    touch-action: none;
}
canvas { display: block; background: #000; }

/* =====================
   UI LAYER
===================== */
#uiLayer {
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none; z-index: 100;
}

/* Buttons */
button {
    font-family: 'Arial', sans-serif;
    cursor: pointer;
}
button.uiButton {
    margin: 10px; padding: 15px 30px;
    background: #0ff; color: #000;
    border: none; border-radius: 10px;
    font-size: 1em; transition: 0.2s;
}
button.uiButton:hover { background: #0aa; color: #fff; }

/* =====================
   SCREENS
===================== */
#menuScreen, #deathScreen, #shopScreen, #optionsScreen, #leaderboardScreen, #creditsScreen, #bossIntro {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    display: flex; justify-content: center; align-items: center;
    flex-direction: column;
    background: rgba(0,0,0,0.85);
    color: #0ff;
    font-size: 2em;
    z-index: 100;
    transition: opacity 0.5s;
    opacity: 1;
}
#menuScreen.hide, #deathScreen.hide, #shopScreen.hide, #optionsScreen.hide, #leaderboardScreen.hide, #creditsScreen.hide, #bossIntro.hide {
    opacity: 0; pointer-events: none;
}

/* =====================
   MOBILE CONTROLS
===================== */
#mobileControls {
    position: fixed; bottom: 20px; width: 100%;
    display: flex; justify-content: space-around;
    z-index: 99;
}
.mobileBtn {
    width: 80px; height: 80px;
    border-radius: 50%;
    background: rgba(0,255,255,0.3);
    border: 2px solid #0ff;
    touch-action: none;
}
.mobileBtn:active { background: rgba(0,255,255,0.7); }

/* =====================
   BIOME OVERLAY
===================== */
#biomeOverlay {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    mix-blend-mode: overlay;
    pointer-events: none;
}

/* Particle system */
.particle {
    position: absolute;
    pointer-events: none;
    width: 5px; height: 5px;
    border-radius: 50%;
    background: #fff;
}

/* Font import */
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
body { font-family: 'Press Start 2P', monospace; }
audio { display: none; }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<div id="uiLayer">
    <!-- MENU -->
    <div id="menuScreen">
        <div>PARKOUR ULTIMATE SOUL<br>GOD MODE 7.1 FULL</div>
        <button class="uiButton" onclick="startGame()">START</button>
        <button class="uiButton" onclick="showOptions()">OPTIONS</button>
        <button class="uiButton" onclick="showShop()">SHOP</button>
        <button class="uiButton" onclick="showLeaderboard()">LEADERBOARD</button>
        <button class="uiButton" onclick="showCredits()">CREDITS</button>
    </div>

    <!-- DEATH -->
    <div id="deathScreen" class="hide">
        <div>YOU DIED</div>
        <button class="uiButton" onclick="restartGame()">RETRY</button>
        <button class="uiButton" onclick="showMenu()">MENU</button>
    </div>
    <!-- SHOP -->
    <div id="shopScreen" class="hide">
        <div>SHOP</div>
        <button class="uiButton" onclick="buyUpgrade('speed')">SPEED</button>
        <button class="uiButton" onclick="buyUpgrade('jump')">JUMP</button>
        <button class="uiButton" onclick="buyUpgrade('dash')">DASH</button>
        <button class="uiButton" onclick="buyUpgrade('shield')">SHIELD</button>
        <button class="uiButton" onclick="buyUpgrade('revive')">REVIVE</button>
        <button class="uiButton" onclick="buyUpgrade('skin')">SKIN</button>
        <button class="uiButton" onclick="closeShop()">BACK</button>
    </div>

    <!-- OPTIONS -->
    <div id="optionsScreen" class="hide">
        <div>OPTIONS</div>
        <button class="uiButton" onclick="toggleAudio()">TOGGLE MUSIC</button>
        <button class="uiButton" onclick="closeOptions()">BACK</button>
    </div>

    <!-- LEADERBOARD -->
    <div id="leaderboardScreen" class="hide">
        <div>LEADERBOARD</div>
        <div id="leaderboardList">No records yet</div>
        <button class="uiButton" onclick="closeLeaderboard()">BACK</button>
    </div>

    <!-- CREDITS -->
    <div id="creditsScreen" class="hide">
        <div>CREDITS</div>
        <div>Created by Ngọc Khôi Nguyễn</div>
        <button class="uiButton" onclick="closeCredits()">BACK</button>
    </div>

    <!-- BOSS INTRO -->
    <div id="bossIntro" class="hide">
        <div id="bossName">BOSS</div>
    </div>

    <!-- MOBILE CONTROLS -->
    <div id="mobileControls">
        <div class="mobileBtn" id="leftBtn">◀</div>
        <div class="mobileBtn" id="jumpBtn">▲</div>
        <div class="mobileBtn" id="dashBtn">▶</div>
    </div>

    <!-- BIOME OVERLAY -->
    <div id="biomeOverlay"></div>
</div>

<!-- AUDIO -->
<audio id="bgMusic" loop src="bgm.mp3"></audio>
<audio id="jumpSnd" src="jump.wav"></audio>
<audio id="dashSnd" src="dash.wav"></audio>
<audio id="hitSnd" src="hit.wav"></audio>
<audio id="bossSnd" src="boss.wav"></audio>
<audio id="coinSnd" src="coin.wav"></audio>

<script>
// ===== PHẦN 2 =====
// =====================
// GLOBAL VARIABLES
// =====================
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;

let gameState = 'menu';
let keys = {};
let player = {};
let platforms = [];
let enemies = [];
let particles = [];
let biomes = [];
let currentBiome = 0;
let camera = {x:0, y:0};
let upgrades = {speed:0, jump:0, dash:0, shield:false, revive:0, skin:0};
let coins = 0;
let audio = {
    bg: document.getElementById('bgMusic'),
    jump: document.getElementById('jumpSnd'),
    dash: document.getElementById('dashSnd'),
    hit: document.getElementById('hitSnd'),
    boss: document.getElementById('bossSnd'),
    coin: document.getElementById('coinSnd')
};
let lastTime = 0;
let bosses = [];
let boss = null;

// =====================
// EVENT LISTENERS
// =====================
window.addEventListener('keydown', e=>keys[e.code]=true);
window.addEventListener('keyup', e=>keys[e.code]=false);
window.addEventListener('resize', ()=>{
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
});

// =====================
// MOBILE BUTTONS
// =====================
document.getElementById('leftBtn').addEventListener('touchstart',()=>keys['ArrowLeft']=true);
document.getElementById('leftBtn').addEventListener('touchend',()=>keys['ArrowLeft']=false);
document.getElementById('jumpBtn').addEventListener('touchstart',()=>keys['Space']=true);
document.getElementById('jumpBtn').addEventListener('touchend',()=>keys['Space']=false);
document.getElementById('dashBtn').addEventListener('touchstart',()=>keys['KeyX']=true);
document.getElementById('dashBtn').addEventListener('touchend',()=>keys['KeyX']=false);

// =====================
// KEY SHORTCUTS
// =====================
window.addEventListener('keydown', e=>{
    if(e.code==='KeyR') restartGame();
    if(e.code==='KeyM') showMenu();
    if(e.code==='KeyS') showShop();
    if(e.code==='KeyO') showOptions();
    if(e.code==='KeyL') showLeaderboard();
});
// ===== PHẦN 3 =====
// =====================
// PLAYER INIT
// =====================
function initPlayer(){
    player = {
        x: width/2, y: height-150,
        w: 50, h: 80,
        vx:0, vy:0,
        speed:5+upgrades.speed,
        jump:15+upgrades.jump,
        dash:20+upgrades.dash,
        onGround:false,
        shield: upgrades.shield,
        dashCooldown:0,
        doubleJump:true,
        health:100,
        maxHealth:100
    };
}

// =====================
// PLATFORM GENERATION
// =====================
function generatePlatforms(){
    platforms = [];
    let y = height - 50;
    for(let i=0;i<200;i++){
        let w = 100 + Math.random()*200;
        platforms.push({x:i*250 + Math.random()*100, y:y, w:w, h:20, type:'normal'});
        y -= Math.random()*100;
        if(y<100) y = height - 50;
    }
}

// =====================
// PLAYER INPUT
// =====================
function handleInput(){
    // Left / Right movement
    if(keys['ArrowLeft']) player.vx = -player.speed;
    else if(keys['ArrowRight']) player.vx = player.speed;
    else player.vx = 0;

    // Jump / Double Jump
    if(keys['Space']){
        if(player.onGround){
            player.vy = -player.jump;
            player.onGround = false;
            audio.jump.play();
            player.doubleJump = true;
        } else if(player.doubleJump){
            player.vy = -player.jump;
            player.doubleJump = false;
            audio.jump.play();
        }
    }

    // Dash
    if(keys['KeyX'] && player.dashCooldown <= 0){
        let dir = (keys['ArrowRight'] ? 1 : (keys['ArrowLeft'] ? -1 : Math.sign(player.vx)));
        player.vx += dir * player.dash;
        player.dashCooldown = 0.5;
        audio.dash.play();
    }
}

// =====================
// PLAYER PHYSICS
// =====================
function updatePlayer(dt){
    player.vy += 50 * dt; // Gravity
    player.x += player.vx;
    player.y += player.vy;

    if(player.dashCooldown > 0) player.dashCooldown -= dt;
    player.onGround = false;

    for(let p of platforms){
        if(player.x + player.w > p.x && player.x < p.x + p.w &&
           player.y + player.h > p.y && player.y + player.h < p.y + p.h + 20 &&
           player.vy >= 0){
            player.y = p.y - player.h;
            player.vy = 0;
            player.onGround = true;
        }
    }

    if(player.y > height + 200) gameOver();
}

// =====================
// CAMERA
// =====================
function updateCamera(){
    camera.x = player.x - width/2;
    camera.y = player.y - height/2;
}

// =====================
// RENDER FUNCTIONS
// =====================
function renderPlatforms(){
    ctx.fillStyle = 'gray';
    for(let p of platforms) ctx.fillRect(p.x,p.y,p.w,p.h);
}
function renderPlayer(){
    ctx.fillStyle = player.shield ? 'cyan' : 'white';
    ctx.fillRect(player.x,player.y,player.w,player.h);
}

// =====================
// BIOMES
// =====================
function initBiomes(){
    biomes = [
        {name:'Neon City', color:'rgba(0,255,255,0.2)'},
        {name:'Lava Hell', color:'rgba(255,50,0,0.2)'},
        {name:'Cyber Desert', color:'rgba(255,255,0,0.2)'},
        {name:'Frozen Void', color:'rgba(0,255,255,0.2)'},
        {name:'Toxic Swamp', color:'rgba(0,150,0,0.2)'},
        {name:'Sky Temple', color:'rgba(255,255,255,0.2)'},
        {name:'Starfield', color:'rgba(200,200,255,0.2)'},
        {name:'Quantum Forest', color:'rgba(100,255,100,0.2)'},
        {name:'Infinity Ruins', color:'rgba(255,100,255,0.2)'},
        {name:'Rainbow Horizon', color:'rgba(255,0,255,0.2)'}
    ];
}

function checkBiome(){
    currentBiome = Math.floor(player.x / 1000) % biomes.length;
    document.getElementById('biomeOverlay').style.background = biomes[currentBiome].color;
}

// =====================
// PARTICLE SYSTEM
// =====================
function createParticle(x,y,vx=0,vy=0,life=1,color='white'){
    if(particles.length < 300) particles.push({x:x,y:y,vx:vx,vy:vy,life:life,color:color});
}
function updateParticles(dt){
    for(let i=particles.length-1;i>=0;i--){
        let p=particles[i];
        p.x += p.vx*dt*60;
        p.y += p.vy*dt*60;
        p.life -= dt;
        if(p.life <= 0) particles.splice(i,1);
    }
}
function renderParticles(){
    for(let p of particles){
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x,p.y,5,5);
    }
}

// =====================
// ENVIRONMENT PARTICLES
// =====================
function spawnEnvironmentParticles(){
    switch(biomes[currentBiome].name){
        case 'Neon City':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,1,1,'cyan');
            break;
        case 'Lava Hell':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,-1,1,'orange');
            break;
        case 'Frozen Void':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,1,1,'lightblue');
            break;
        case 'Toxic Swamp':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,1,1,'green');
            break;
        case 'Starfield':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,0,1,'white');
            break;
        case 'Quantum Forest':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,0.5,1,'lime');
            break;
        case 'Infinity Ruins':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,0.5,1,'magenta');
            break;
        case 'Rainbow Horizon':
            for(let i=0;i<5;i++){
                let colors=['red','orange','yellow','green','blue','indigo','violet'];
                createParticle(Math.random()*width+camera.x,Math.random()*height+camera.y,0,Math.random(),1,colors[Math.floor(Math.random()*colors.length)]);
            }
            break;
    }
}

// =====================
// MOTION TRAIL
// =====================
setInterval(()=>{
    if(gameState==='playing') createParticle(player.x+player.w/2,player.y+player.h,(Math.random()-0.5)*1,-Math.random()*1,0.5,'yellow');
},50);
// ===== PHẦN 4 =====
// =====================
// ENEMIES & BOSS
// =====================
class Boss{
    constructor(name,x,y,w,h){
        this.name=name; this.x=x; this.y=y; this.w=w; this.h=h;
        this.phase=1; this.health=100; this.maxHealth=100; this.rage=false;
        this.projectiles=[]; this.active=true;
    }
    update(dt){
        if(!this.active) return;
        if(this.health<=this.maxHealth/2 && !this.rage){ this.rage=true; this.phase=4; }
        switch(this.phase){
            case 1: this.phaseOne(dt); break;
            case 2: this.phaseTwo(dt); break;
            case 3: this.phaseThree(dt); break;
            case 4: this.phaseFour(dt); break;
            case 5: this.phaseFive(dt); break;
        }
        for(let i=this.projectiles.length-1;i>=0;i--){
            let p=this.projectiles[i];
            p.x+=p.vx*dt*60; p.y+=p.vy*dt*60; p.life-=dt;
            if(p.life<=0 || p.x<camera.x-100 || p.x>camera.x+width+100) this.projectiles.splice(i,1);
        }
    }
    phaseOne(dt){ this.x+=Math.sin(Date.now()/500)*1.5; this.shootCurved('cyan'); }
    phaseTwo(dt){ if(player.x<this.x) this.x-=2; else this.x+=2; if(Math.random()<0.01) this.groundSmash(); }
    phaseThree(dt){ this.y=200+Math.sin(Date.now()/400)*50; if(Math.random()<0.02) this.shootCurved('red'); }
    phaseFour(dt){ this.x+=Math.sin(Date.now()/300)*3; this.shootCurved('orange'); }
    phaseFive(dt){ if(Math.random()<0.05) this.ultimateAttack(); }
    shootCurved(color='white'){ if(Math.random()<0.05) this.projectiles.push({x:this.x+this.w/2,y:this.y+this.h/2,vx:(Math.random()-0.5)*5,vy:3+Math.random()*2,life:5,color:color}); }
    groundSmash(){ for(let i=0;i<5;i++) createParticle(this.x+this.w/2,this.y+this.h,(Math.random()-0.5)*3,-Math.random()*2,1,'orange'); }
    ultimateAttack(){ for(let i=0;i<20;i++) this.projectiles.push({x:this.x+this.w/2,y:this.y+this.h/2,vx:(Math.random()-0.5)*10,vy:Math.random()*5,life:5,color:'red'}); }
    render(){
        if(!this.active) return;
        ctx.fillStyle=this.rage?'orange':'red'; ctx.fillRect(this.x,this.y,this.w,this.h);
        ctx.fillStyle='black'; ctx.fillRect(this.x,this.y-10,this.w,5);
        ctx.fillStyle='lime'; ctx.fillRect(this.x,this.y-10,this.w*(this.health/this.maxHealth),5);
        for(let p of this.projectiles){ ctx.fillStyle=p.color; ctx.fillRect(p.x,p.y,5,5); }
    }
}

// =====================
// INITIALIZE BOSSES
// =====================
bosses = [
    new Boss('Shadow Orb', width+200, 200, 80, 80),
    new Boss('Titan Runner', width+400, height-150, 100, 120),
    new Boss('Sky Serpent', width+600, 150, 120, 60)
];

function updateBoss(dt){
    if(!boss && player.x>500) boss = bosses[0];
    if(boss) boss.update(dt);
}

// =====================
// ENEMIES
// =====================
function spawnEnemies(){
    enemies = [];
    for(let i=0;i<5;i++){
        enemies.push({x:Math.random()*2000, y:height-100, w:40, h:60, vx:0, vy:0});
    }
}

function renderEnemies(){
    for(let e of enemies){
        ctx.fillStyle='red'; ctx.fillRect(e.x,e.y,e.w,e.h);
    }
    if(boss) boss.render();
}

// =====================
// SHOP & UPGRADES
// =====================
function buyUpgrade(type){
    switch(type){
        case 'speed': upgrades.speed+=1; player.speed=5+upgrades.speed; break;
        case 'jump': upgrades.jump+=1; player.jump=15+upgrades.jump; break;
        case 'dash': upgrades.dash+=5; break;
        case 'shield': upgrades.shield=true; player.shield=true; break;
        case 'revive': upgrades.revive+=1; break;
        case 'skin': upgrades.skin+=1; break;
    }
    coins += 10;
    audio.coin.play();
}
function closeShop(){
    document.getElementById('shopScreen').classList.add('hide');
    gameState='playing';
}
function startGame(){
    document.getElementById('menuScreen').classList.add('hide');
    gameState='playing';
    initGame();
}
function restartGame(){
    initPlayer();
    player.x = width/2; player.y = height-150;
    gameState='playing';
    requestAnimationFrame(loop);
}
function gameOver(){
    if(upgrades.revive>0){
        upgrades.revive--;
        initPlayer();
    } else {
        let scores = JSON.parse(localStorage.getItem('scores')||'[]');
        scores.push(Math.floor(player.x));
        localStorage.setItem('scores', JSON.stringify(scores));
        showDeath();
    }
}

// =====================
// SHOW / HIDE SCREENS
// =====================
function showMenu(){
    document.getElementById('menuScreen').classList.remove('hide');
    document.getElementById('deathScreen').classList.add('hide');
    document.getElementById('shopScreen').classList.add('hide');
    document.getElementById('bossIntro').classList.add('hide');
    gameState='menu';
}
function showShop(){
    document.getElementById('shopScreen').classList.remove('hide');
    document.getElementById('menuScreen').classList.add('hide');
    gameState='shop';
}
function showDeath(){
    document.getElementById('deathScreen').classList.remove('hide');
    gameState='dead';
}
function showOptions(){
    alert('OPTIONS: Audio toggle with M, other keys customizable');
}
function showLeaderboard(){
    let scores = JSON.parse(localStorage.getItem('scores')||'[]');
    alert('Leaderboard:\n' + scores.map((s,i)=>`${i+1}. ${s}`).join('\n'));
}
// ===== PHẦN 5 =====
// =====================
// GAME INIT
// =====================
function initGame(){
    initPlayer();
    generatePlatforms();
    initBiomes();
    spawnEnemies();
    audio.bg.play();
    lastTime = performance.now();
    requestAnimationFrame(loop);
}

// =====================
// PLAYER INPUT (MOBILE)
// =====================
document.getElementById('leftBtn').addEventListener('touchstart',()=>keys['ArrowLeft']=true);
document.getElementById('leftBtn').addEventListener('touchend',()=>keys['ArrowLeft']=false);
document.getElementById('jumpBtn').addEventListener('touchstart',()=>keys['Space']=true);
document.getElementById('jumpBtn').addEventListener('touchend',()=>keys['Space']=false);
document.getElementById('dashBtn').addEventListener('touchstart',()=>keys['KeyX']=true);
document.getElementById('dashBtn').addEventListener('touchend',()=>keys['KeyX']=false);

// =====================
// KEY SHORTCUTS
// =====================
window.addEventListener('keydown', e=>{
    if(e.code==='KeyR') restartGame();
    if(e.code==='KeyM') showMenu();
    if(e.code==='KeyS') showShop();
    if(e.code==='KeyO') showOptions();
    if(e.code==='KeyL') showLeaderboard();
});

// =====================
// AUDIO TOGGLE
// =====================
function toggleAudio(){
    if(audio.bg.paused) audio.bg.play();
    else audio.bg.pause();
}

// =====================
// GAME LOOP
// =====================
function loop(timestamp){
    const dt = (timestamp - lastTime)/1000;
    lastTime = timestamp;
    if(gameState==='playing'){
        update(dt);
        render();
        requestAnimationFrame(loop);
    }
}

// =====================
// UPDATE FUNCTION
// =====================
function update(dt){
    handleInput();
    updatePlayer(dt);
    updateCamera();
    updateParticles(dt);
    spawnEnvironmentParticles();
    checkBiome();
    updateBoss(dt);
}

// =====================
// RENDER FUNCTION
// =====================
function render(){
    ctx.clearRect(0,0,width,height);
    ctx.save();
    ctx.translate(-camera.x,-camera.y);
    renderPlatforms();
    renderPlayer();
    renderParticles();
    renderEnemies();
    ctx.restore();
}

// =====================
// SPAWN ENVIRONMENT PARTICLES (optimized)
// =====================
function spawnEnvironmentParticles(){
    switch(biomes[currentBiome].name){
        case 'Neon City':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,1,1,'cyan');
            break;
        case 'Lava Hell':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,-1,1,'orange');
            break;
        case 'Frozen Void':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,1,1,'lightblue');
            break;
        case 'Toxic Swamp':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,1,1,'green');
            break;
        case 'Starfield':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,0,1,'white');
            break;
        case 'Quantum Forest':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,0.5,1,'lime');
            break;
        case 'Infinity Ruins':
            for(let i=0;i<2;i++) createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,0.5,1,'magenta');
            break;
        case 'Rainbow Horizon':
            for(let i=0;i<5;i++){
                let colors=['red','orange','yellow','green','blue','indigo','violet'];
                createParticle(Math.random()*width+camera.x, Math.random()*height+camera.y,0,Math.random(),1,colors[Math.floor(Math.random()*colors.length)]);
            }
            break;
    }
}

// =====================
// SPAWN PLAYER MOTION TRAIL
// =====================
setInterval(()=>{
    if(gameState==='playing') createParticle(player.x+player.w/2, player.y+player.h, (Math.random()-0.5)*1, -Math.random()*1, 0.5, 'yellow');
},50);

// =====================
// INITIAL MENU
// =====================
showMenu();
